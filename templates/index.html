{% extends "base.html" %}
{% block title %}UzzeStore - Moda e Estilo para Todos{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/modern-products.css') }}">
<!-- Preload banner images -->
<link rel="preload" as="image" href="{{ url_for('static', filename='banner/banner3.webp') }}">
{% endblock %}

{% block content %}
<!-- Hero Section -->
 
            

    <!-- Categoria MODE TEXAS (dois cards estilizados: Cowgirl e Cowboy) -->
   
<script>
// Modern Image Fallback System
if (!window.imgFallback) {
  window.imgFallback = function(el, w=400, h=400, text='Produto') {
    el.onerror = null;
    
    // Criar um SVG moderno com gradiente e √≠cone
    const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='${w}' height='${h}' viewBox='0 0 ${w} ${h}'>
      <defs>
        <linearGradient id='bgGrad' x1='0%' y1='0%' x2='100%' y2='100%'>
          <stop offset='0%' style='stop-color:#f8f9fa;stop-opacity:1' />
          <stop offset='100%' style='stop-color:#e9ecef;stop-opacity:1' />
        </linearGradient>
        <linearGradient id='iconGrad' x1='0%' y1='0%' x2='100%' y2='100%'>
          <stop offset='0%' style='stop-color:#e67e22;stop-opacity:0.3' />
          <stop offset='100%' style='stop-color:#f39c12;stop-opacity:0.3' />
        </linearGradient>
      </defs>
      <rect width='100%' height='100%' fill='url(#bgGrad)'/>
      <g transform='translate(${w/2-30}, ${h/2-30})'>
        <rect x='0' y='15' width='60' height='45' rx='5' fill='url(#iconGrad)' stroke='#6c757d' stroke-width='2'/>
        <circle cx='45' cy='25' r='5' fill='#6c757d'/>
        <polygon points='10,45 25,30 40,40 50,35 50,50 10,50' fill='#6c757d'/>
      </g>
      <text x='50%' y='${h-20}' text-anchor='middle' font-family='Inter, -apple-system, sans-serif' font-size='14' fill='#6c757d' font-weight='600'>${text}</text>
    </svg>`;
    
    el.src = 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(svg);
    el.alt = text;
    el.className += ' img-fallback';
    
    // Adicionar efeito de carregamento
    el.style.opacity = '0.7';
    setTimeout(() => {
      el.style.opacity = '1';
    }, 300);
  };
}

// Sistema de lazy loading melhorado
document.addEventListener('DOMContentLoaded', function() {
  // Intersection Observer para lazy loading
  if ('IntersectionObserver' in window) {
    const imageObserver = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const img = entry.target;
          if (img.dataset.src && !img.src) {
            img.src = img.dataset.src;
          }
          observer.unobserve(img);
        }
      });
    });

    document.querySelectorAll('img[data-src]').forEach(img => {
      imageObserver.observe(img);
    });
  }

  // Anima√ß√£o de fade-in para produtos
  const productCards = document.querySelectorAll('.produto-card');
  productCards.forEach((card, index) => {
    card.style.opacity = '0';
    card.style.transform = 'translateY(20px)';
    setTimeout(() => {
      card.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
      card.style.opacity = '1';
      card.style.transform = 'translateY(0)';
    }, index * 100);
  });
});
</script>

<!-- Filter Section -->
<style>
/* Tela limpa overlay */
#clean-screen-overlay{
    position:fixed;
    inset:0;
    background:#fff;
    z-index:99999;
    display:flex;
    align-items:center;
    justify-content:center;
}
#clean-screen-overlay .clean-close{
    position:absolute;
    top:16px;
    right:16px;
    background:rgba(0,0,0,0.6);
    color:#fff;
    border:none;
    width:44px;
    height:44px;
    border-radius:50%;
    font-size:22px;
    cursor:pointer;
}
</style>

<script>
function openCleanScreen(event){
    try{
        if(event && event.preventDefault) event.preventDefault();
        if(document.getElementById('clean-screen-overlay')) return;
        const overlay = document.createElement('div');
        overlay.id = 'clean-screen-overlay';
        overlay.setAttribute('role','dialog');
        overlay.setAttribute('aria-modal','true');
        overlay.innerHTML = '<button class="clean-close" aria-label="Fechar tela limpa">\u00d7</button>';
        document.body.appendChild(overlay);

        const btn = overlay.querySelector('.clean-close');
        btn.addEventListener('click', closeCleanScreen);

        // Fecha ao clicar no fundo
        overlay.addEventListener('click', function(e){ if(e.target === overlay) closeCleanScreen(); });

        // Fecha com ESC
        document.addEventListener('keydown', escHandler);
    }catch(err){ console.error('openCleanScreen error', err); }
}

function closeCleanScreen(){
    const o = document.getElementById('clean-screen-overlay');
    if(o) o.remove();
    document.removeEventListener('keydown', escHandler);
}

function escHandler(e){ if(e.key === 'Escape') closeCleanScreen(); }

// Listener para imagens de produto (qualquer elemento .product-image)
document.addEventListener('click', function(e){
    try{
        const productImage = e.target.closest && e.target.closest('.product-image');
        if(productImage){
            // evitar interferir com bot√µes dentro do card
            if(e.target.closest('button') || e.target.closest('a')) return;
            openCleanScreen(e);
        }
    }catch(err){ /* ignore */ }
});

// Mostrar apenas produtos de uma categoria (chamado pelos hero-cards)
function showCategory(category){
    try{
        // Garantir que os produtos j√° foram carregados
        if(!allProducts || allProducts.length === 0){
            // tenta carregar produtos se ainda n√£o carregados
            loadProducts();
        }

        // Atualiza filtros de categoria (client-side)
        activeFilters.categories = [category];

        // Atualiza checkboxes no painel de filtros (se existirem)
        document.querySelectorAll('.filter-options input[type="checkbox"]').forEach(cb => {
            if(cb.value === ''){
                cb.checked = false; // desmarca 'Todas as categorias'
            } else {
                cb.checked = (cb.value === category);
            }
        });

        filterProducts();

        // Rolar para a √°rea de produtos
        const productsSection = document.querySelector('.products-container');
        if(productsSection){ productsSection.scrollIntoView({behavior: 'smooth'}); }
    }catch(e){ console.error('showCategory error', e); }
}
</script>
<section class="filter-section">
    <div class="filter-left">
        <button class="filter-toggle" onclick="toggleFilters()">
            <i class="fas fa-sliders-h"></i> Mostrar filtros
        </button>
        <span class="product-count">{{ produtos|length }} produto{{ 's' if produtos|length != 1 else '' }}</span>
    </div>
</section>

<!-- Panel de Filtros -->
<div class="filters-panel" id="filters-panel">
    <div class="filters-container">
        <div class="filters-header">
            <h3>üîç Filtros</h3>
            <button class="close-filters" onclick="toggleFilters()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="filters-content">
            <!-- Filtro por Categoria -->
            <div class="filter-group">
                <h4>Categoria</h4>
                <div class="filter-options">
                    <label class="filter-option">
                        <input type="checkbox" value="" onchange="filterProducts()" checked>
                        <span class="checkmark"></span>
                        Todas as categorias
                    </label>
                    {% for categoria in categorias %}
                    <label class="filter-option">
                        <input type="checkbox" value="{{ categoria.categoria }}" onchange="filterProducts()">
                        <span class="checkmark"></span>
                        {{ categoria.categoria }}
                    </label>
                    {% endfor %}
                </div>
            </div>

            <!-- Filtro por Pre√ßo -->
            <div class="filter-group">
                <h4>Faixa de Pre√ßo</h4>
                <div class="price-range">
                    <div class="price-inputs">
                        <div>
                            <label>M√≠n:</label>
                            <input type="number" id="min-price" placeholder="0" min="0" onchange="filterProducts()">
                        </div>
                        <div>
                            <label>M√°x:</label>
                            <input type="number" id="max-price" placeholder="1000" min="0" onchange="filterProducts()">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Filtro por Tamanho -->
            <div class="filter-group">
                <h4>Tamanho</h4>
                <div class="size-options">
                    <label class="size-option">
                        <input type="checkbox" value="" onchange="filterProducts()" checked>
                        <span class="size-checkmark">Todos</span>
                    </label>
                    <label class="size-option">
                        <input type="checkbox" value="PP" onchange="filterProducts()">
                        <span class="size-checkmark">PP</span>
                    </label>
                    <label class="size-option">
                        <input type="checkbox" value="P" onchange="filterProducts()">
                        <span class="size-checkmark">P</span>
                    </label>
                    <label class="size-option">
                        <input type="checkbox" value="M" onchange="filterProducts()">
                        <span class="size-checkmark">M</span>
                    </label>
                    <label class="size-option">
                        <input type="checkbox" value="G" onchange="filterProducts()">
                        <span class="size-checkmark">G</span>
                    </label>
                    <label class="size-option">
                        <input type="checkbox" value="GG" onchange="filterProducts()">
                        <span class="size-checkmark">GG</span>
                    </label>
                    <label class="size-option">
                        <input type="checkbox" value="XG" onchange="filterProducts()">
                        <span class="size-checkmark">XG</span>
                    </label>
                </div>
            </div>

            <!-- Filtros R√°pidos -->
            <div class="filter-group">
                <h4>Filtros R√°pidos</h4>
                <div class="quick-filters">
                    <button class="quick-filter" onclick="setQuickFilter('promocao')">
                        üè∑Ô∏è Promo√ß√£o
                    </button>
                    <button class="quick-filter" onclick="setQuickFilter('lancamento')">
                        ‚≠ê Lan√ßamentos
                    </button>
                    <button class="quick-filter" onclick="setQuickFilter('mais-vendidos')">
                        üî• Mais Vendidos
                    </button>
                </div>
            </div>

            <!-- Bot√µes de A√ß√£o -->
            <div class="filter-actions">
                <button class="btn-clear-filters" onclick="clearAllFilters()">
                    üóëÔ∏è Limpar Filtros
                </button>
                <button class="btn-apply-filters" onclick="toggleFilters()">
                    ‚úÖ Aplicar Filtros
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Products Section -->
<section class="products-container">
    <div class="products-header">
        <div class="active-filters" id="active-filters" style="display: none;">
            <span class="active-filters-label">Filtros ativos:</span>
            <div class="active-filters-list" id="active-filters-list"></div>
        </div>
    </div>

    {% if produtos %}
        <div class="products-grid" id="products-grid">
            <!-- Produtos com dados para filtros -->
            {% for produto in produtos %}
                <div class="produto-card"
                     data-product-id="{{ produto.id }}"
                     data-preco="{{ ('%.2f'|format(produto.preco|float)) }}"
                     data-categoria="{{ produto.categoria or '' }}"
                     data-nome="{{ produto.nome|e }}"
                     data-imagem="{% if produto.imagem and produto.imagem.strip() %}{% if produto.imagem.startswith('http') or produto.imagem.startswith('/') %}{{ produto.imagem }}{% else %}{{ url_for('static', filename=produto.imagem) }}{% endif %}{% else %}{% endif %}"
                     data-id="{{ produto.id }}"
                     onclick="abrirProduto({{ produto.id }})"
                     style="cursor: pointer;">
                  
                  <div class="product-image">
                        {% if produto.imagem and produto.imagem.strip() %}
                            {% if produto.imagem.startswith('http') or produto.imagem.startswith('/') %}
                                <!-- Imagem externa: mant√©m comportamento padr√£o -->
                                <img src="{{ produto.imagem }}"
                                     alt="{{ produto.nome }}"
                                     loading="lazy"
                                     onload="this.style.opacity='1'"
                                     onerror="imgFallback(this, 400, 400, 'Produto')"
                                     style="opacity: 0; transition: opacity 0.3s ease;">
                            {% else %}
                                {# Gerar nomes para vers√µes otimizadas: base-400.webp e base-400.jpg/png #}
                                {% set parts = produto.imagem.rsplit('.', 1) %}
                                {% set base = parts[0] %}
                                {% set ext = parts[1] %}
                                <picture>
                                    <source type="image/webp" data-srcset="{{ url_for('static', filename=base ~ '-400.webp') }}">
                                    <source data-srcset="{{ url_for('static', filename=base ~ '-400.' ~ ext) }}">
                                    <img data-src="{{ url_for('static', filename=base ~ '-400.' ~ ext) }}"
                                         alt="{{ produto.nome }}"
                                         loading="lazy"
                                         onload="this.style.opacity='1'"
                                         onerror="imgFallback(this, 400, 400, 'Produto')"
                                         style="opacity: 0; transition: opacity 0.3s ease;">
                                </picture>
                            {% endif %}
                        {% else %}
                            <img src="" alt="{{ produto.nome }}" loading="lazy" style="opacity: 0; transition: opacity 0.3s ease;" onerror="imgFallback(this,400,400,'Produto')">
                        {% endif %}
                        
                        <!-- Badge de categoria -->
                        {% if produto.categoria %}
                        <div class="product-badge">{{ produto.categoria }}</div>
                        {% endif %}
                        
                        <!-- Overlay com bot√µes de a√ß√£o r√°pida -->
                        <div class="product-overlay">
                            <button class="btn-quick-view" onclick="event.stopPropagation(); visualizarRapido({{ produto.id }})" title="Visualiza√ß√£o r√°pida">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn-quick-cart" onclick="event.stopPropagation(); adicionarCarrinhoRapido({{ produto.id }})" title="Adicionar ao carrinho">
                                <i class="fas fa-shopping-bag"></i>
                            </button>
                            <button class="btn-quick-fav" onclick="event.stopPropagation(); toggleFavorito({{ produto.id }})" title="Adicionar aos favoritos">
                                <i class="far fa-heart"></i>
                            </button>
                        </div>
                  </div>
                  
                  <div class="product-info">
                      <h3 class="produto-nome">{{ produto.nome }}</h3>
                      {% if produto.categoria %}
                          <span class="produto-categoria" style="display: none;">{{ produto.categoria }}</span>
                      {% endif %}
                      {% if produto.tamanhos %}
                          <span class="produto-tamanhos" style="display: none;">{{ produto.tamanhos }}</span>
                      {% endif %}
                      
                      <!-- Avalia√ß√£o -->
                      <div class="product-rating">
                          <div class="stars">
                              <i class="fas fa-star"></i>
                              <i class="fas fa-star"></i>
                              <i class="fas fa-star"></i>
                              <i class="fas fa-star"></i>
                              <i class="fas fa-star-half-alt"></i>
                          </div>
                          <span class="rating-count">(127)</span>
                      </div>
                      
                      <div class="produto-preco">
                          <span class="preco-atual">R$ {{ "%.2f"|format(produto.preco|float)|replace('.', ',') }}</span>
                          <span class="preco-original">R$ {{ "%.2f"|format(produto.preco * 1.3)|replace('.', ',') }}</span>
                      </div>
                      
                      <!-- Bot√£o principal -->
                      <button class="btn-add-cart" onclick="event.stopPropagation(); adicionarCarrinhoRapido({{ produto.id }})">
                          <i class="fas fa-shopping-bag"></i> Adicionar ao Carrinho
                      </button>
                  </div>
                </div>
            {% endfor %}
        </div>

        <!-- Mensagem quando n√£o h√° produtos filtrados -->
        <div class="no-products-message" id="no-products" style="display: none;">
            <div style="text-align: center; padding: 80px 20px; color: #666;">
                <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.3;"></i>
                <h3>Nenhum produto encontrado</h3>
                <p>Tente ajustar os filtros ou buscar por outros termos</p>
                <button onclick="clearAllFilters()" class="btn-clear-filters" style="margin-top: 20px;">
                    üîÑ Limpar todos os filtros
                </button>
            </div>
        </div>
    {% else %}
        <div style="text-align: center; padding: 80px 20px; color: #666;">
            <i class="fas fa-box-open" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.3;"></i>
            <h3>Nenhum produto cadastrado</h3>
            <p>Em breve novos produtos incr√≠veis!</p>
        </div>
    {% endif %}
</section>



<style>
/* Hero Section Styles */
.hero-image {
    margin-top: 30px;
    max-width: 1400px;
    margin-left: auto;
    margin-right: auto;
    padding: 0 20px;
}

.hero-accessories-link {
    display: block;
    position: relative;
    overflow: hidden;
    border-radius: 12px;
}

.hero-accessories-link::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0);
    transition: background 0.3s ease;
    pointer-events: none;
}

.hero-accessories-link:hover::after {
    background: rgba(0, 0, 0, 0.1);
}

.hero-accessories-img {
    width: 100%;
    height: auto;
    display: block;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease;
}

.hero-accessories-link:hover .hero-accessories-img {
    transform: scale(1.02);
}

@media (max-width: 768px) {
    .hero-accessories-link {
        border-radius: 8px;
    }
    
    .hero-accessories-img {
        border-radius: 8px;
    }
}

/* Estilos para os cards MODE TEXAS (Cowgirl / Cowboy) */
.hero-texas-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 24px;
    align-items: stretch;
}

.hero-card {
    display: block;
    position: relative;
    height: 380px;
    background-size: cover;
    background-position: center;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0,0,0,0.12);
    transition: transform 0.35s ease, box-shadow 0.35s ease;
}

.hero-card:hover {
    transform: translateY(-6px) scale(1.01);
    box-shadow: 0 18px 50px rgba(0,0,0,0.18);
}

.hero-overlay {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: flex-start;
    padding: 40px;
    background: linear-gradient(90deg, rgba(0,0,0,0.45) 20%, rgba(0,0,0,0.12) 60%);
    color: white;
    gap: 12px;
}

.hero-card-title {
    font-family: 'Playfair Display', serif;
    font-size: 64px;
    letter-spacing: -2px;
    margin: 0;
    text-transform: uppercase;
    font-weight: 800;
    color: white;
    text-shadow: 0 6px 20px rgba(0,0,0,0.5);
}

.hero-card-btn {
    background: transparent;
    border: 1px solid rgba(255,255,255,0.9);
    color: white;
    padding: 10px 20px;
    border-radius: 24px;
    font-weight: 700;
    cursor: pointer;
    margin-top: 6px;
    backdrop-filter: blur(6px);
}

.hero-card-btn:hover {
    background: rgba(255,255,255,0.12);
    transform: translateY(-2px);
}

@media (max-width: 768px) {
    .hero-texas-grid { grid-template-columns: 1fr; }
    .hero-card { height: 320px; border-radius: 12px; }
    .hero-card-title { font-size: 40px; }
}

/* Estilos para o sistema de filtros */
.filters-panel {
    position: fixed;
    top: 0;
    right: -400px;
    width: 400px;
    height: 100vh;
    background: rgb(255, 255, 255);
    box-shadow: -5px 0 20px rgba(0,0,0,0.1);
    z-index: 2000;
    transition: right 0.3s ease;
    overflow-y: auto;
}

.filters-panel.active {
    right: 0;
}

.filters-container {
    padding: 0;
    height: 100%;
    display: flex;
    flex-direction: column;
}

.filters-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 25px;
    border-bottom: 1px solid var(--border-light);
    background: var(--secondary-color);
}

.filters-header h3 {
    margin: 0;
    color: var(--text-primary);
    font-size: 1.2rem;
}

.close-filters {
    background: none;
    border: none;
    font-size: 18px;
    cursor: pointer;
    color: var(--text-secondary);
    padding: 8px;
    border-radius: 50%;
    transition: all 0.3s ease;
}

.close-filters:hover {
    background: var(--border-light);
    color: var(--text-primary);
}

.filters-content {
    flex: 1;
    padding: 25px;
}

.filter-group {
    margin-bottom: 30px;
}

.filter-group h4 {
    margin-bottom: 15px;
    color: var(--text-primary);
    font-size: 14px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-weight: 600;
}

.filter-options {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.filter-option {
    display: flex;
    align-items: center;
    cursor: pointer;
    padding: 8px 0;
    transition: all 0.3s ease;
}

.filter-option:hover {
    color: var(--accent-color);
}

.filter-option input[type="checkbox"] {
    display: none;
}

.checkmark {
    width: 18px;
    height: 18px;
    border: 2px solid var(--border-light);
    border-radius: 4px;
    margin-right: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
}

.filter-option input[type="checkbox"]:checked + .checkmark {
    background: var(--accent-color);
    border-color: var(--accent-color);
}

.filter-option input[type="checkbox"]:checked + .checkmark::after {
    content: "‚úì";
    color: white;
    font-size: 12px;
    font-weight: bold;
}

.price-range {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.price-inputs {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
}

.price-inputs div {
    display: flex;
    flex-direction: column;
}

.price-inputs label {
    font-size: 12px;
    color: var(--text-secondary);
    margin-bottom: 5px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.price-inputs input {
    padding: 8px 12px;
    border: 1px solid var(--border-light);
    border-radius: 6px;
    font-size: 14px;
}

.size-options {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
    margin-top: 10px;
}

.size-option {
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
}

.size-option input[type="checkbox"] {
    display: none;
}

.size-checkmark {
    width: 40px;
    height: 40px;
    border: 2px solid var(--border-light);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    transition: all 0.3s ease;
    background: white;
    color: var(--text-secondary);
}

.size-option:hover .size-checkmark {
    border-color: var(--accent-color);
    color: var(--accent-color);
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.size-option input[type="checkbox"]:checked + .size-checkmark {
    background: var(--accent-color);
    border-color: var(--accent-color);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
}

/* Estilo especial para "Todos" */
.size-option:first-child .size-checkmark {
    font-size: 10px;
    padding: 0 4px;
}

/* Mobile responsivo para tamanhos */
@media (max-width: 768px) {
    .size-options {
        grid-template-columns: repeat(3, 1fr);
        gap: 6px;
    }
    
    .size-checkmark {
        width: 35px;
        height: 35px;
        font-size: 11px;
    }
}

.quick-filters {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.quick-filter {
    background: var(--secondary-color);
    border: 1px solid var(--border-light);
    padding: 10px 15px;
    text-align: left;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.3s ease;
    font-size: 14px;
}

.quick-filter:hover, .quick-filter.active {
    background: var(--accent-color);
    color: white;
    border-color: var(--accent-color);
}

.filter-actions {
    display: flex;
    gap: 10px;
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid var(--border-light);
}

.btn-clear-filters, .btn-apply-filters {
    flex: 1;
    padding: 12px;
    border-radius: 8px;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.btn-clear-filters {
    background: white;
    color: var(--text-secondary);
    border: 1px solid var(--border-light);
}

.btn-clear-filters:hover {
    background: var(--secondary-color);
}

.btn-apply-filters {
    background: var(--primary-color);
    color: white;
    border: 1px solid var(--primary-color);
}

.btn-apply-filters:hover {
    background: var(--accent-color);
    border-color: var(--accent-color);
}

.active-filters {
    background: var(--secondary-color);
    padding: 15px 20px;
    border-radius: 8px;
    margin-bottom: 20px;
    border-left: 4px solid var(--accent-color);
}

.active-filters-label {
    font-size: 12px;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-weight: 600;
    margin-right: 10px;
}

.active-filters-list {
    display: inline-flex;
    flex-wrap: wrap;
    gap: 8px;
}

.active-filter-tag {
    background: var(--accent-color);
    color: white;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 11px;
    display: inline-flex;
    align-items: center;
    gap: 5px;
}

.active-filter-tag .remove {
    cursor: pointer;
    font-weight: bold;
}

/* Melhorar estilos das imagens dos produtos */
.product-image {
    height: 400px;
    background: var(--secondary-color);
    overflow: hidden;
    position: relative;
    border-radius: 12px 12px 0 0;
}

.product-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease;
    display: block;
    background: #f0f0f0;
}

/* Placeholder para imagens que n√£o carregaram */
.product-image img[src=""],
.product-image img:not([src]) {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    position: relative;
}

.product-image img[src=""]:before,
.product-image img:not([src]):before {
    content: 'üì∑ Carregando...';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #999;
    font-size: 14px;
    text-align: center;
}

.product-card:hover .product-image img {
    transform: scale(1.08);
}

/* Badge de categoria */
.product-badge {
    position: absolute;
    top: 12px;
    left: 12px;
    background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
    color: white;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    z-index: 2;
}

/* Overlay com bot√µes de a√ß√£o */
.product-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    z-index: 3;
}

.product-card:hover .product-overlay {
    opacity: 1;
    visibility: visible;
}

.btn-quick-view,
.btn-quick-cart,
.btn-quick-fav {
    width: 45px;
    height: 45px;
    border: none;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.9);
    color: #2c3e50;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    backdrop-filter: blur(10px);
}

.btn-quick-view:hover {
    background: #007bff;
    color: white;
    transform: scale(1.1);
}

.btn-quick-cart:hover {
    background: #28a745;
    color: white;
    transform: scale(1.1);
}

.btn-quick-fav:hover {
    background: #e74c3c;
    color: white;
    transform: scale(1.1);
}

.btn-quick-fav.active {
    background: #e74c3c;
    color: white;
}

/* Avalia√ß√£o dos produtos */
.product-rating {
    display: flex;
    align-items: center;
    gap: 8px;
    margin: 8px 0;
}

.stars {
    color: #ffc107;
    font-size: 14px;
}

.rating-count {
    color: #6c757d;
    font-size: 12px;
}

/* Pre√ßos melhorados */
.produto-preco {
    display: flex;
    flex-direction: column;
    gap: 4px;
    margin: 12px 0;
}

.preco-atual {
    font-size: 1.4rem;
    font-weight: 700;
    color: #28a745;
}

.preco-original {
    font-size: 1rem;
    color: #6c757d;
    text-decoration: line-through;
}

/* Bot√£o melhorado */
.btn-add-cart {
    width: 100%;
    padding: 12px;
    background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.btn-add-cart:hover {
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
}

/* Estilos para cart√µes clic√°veis */
.produto-card {
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
}

.produto-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
}

.produto-card:active {
    transform: translateY(-4px) scale(1.01);
}

/* Anima√ß√£o de clique */
.produto-card::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    background: radial-gradient(circle, rgba(0, 123, 255, 0.3) 0%, transparent 70%);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    transition: all 0.3s ease;
    pointer-events: none;
    z-index: 1;
}

.produto-card:active::after {
    width: 200px;
    height: 200px;
}

/* Nome do produto clic√°vel */
.produto-nome {
    transition: color 0.3s ease;
}

.produto-card:hover .produto-nome {
    color: #007bff;
}

/* Melhorar o layout do product-info */
.product-info {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.produto-nome {
    font-size: 1.1rem;
    font-weight: 600;
    color: #2c3e50;
    margin: 0;
    line-height: 1.4;
    min-height: 2.8rem;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* Responsividade melhorada */
@media (max-width: 768px) {
    .produto-card:hover {
        transform: translateY(-4px) scale(1.01);
    }
    
    .product-overlay {
        opacity: 1;
        visibility: visible;
        background: rgba(0, 0, 0, 0.5);
    }
    
    .btn-quick-view,
    .btn-quick-cart,
    .btn-quick-fav {
        width: 40px;
        height: 40px;
        font-size: 14px;
    }
}

.product-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    color: #ccc;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
}

.product-placeholder i {
    font-size: 3rem;
    margin-bottom: 10px;
    opacity: 0.5;
}

.product-placeholder p {
    font-size: 14px;
    margin: 0;
    opacity: 0.7;
}

/* Melhorar o loading das imagens */
.product-image img[src=""], 
.product-image img:not([src]) {
    display: none;
}

.product-image img {
    opacity: 0;
    transition: opacity 0.3s ease, transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

.product-image img.loaded {
    opacity: 1;
}

/* Overlay para fechar filtros */
.filters-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 1999;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.filters-overlay.active {
    opacity: 1;
    visibility: visible;
}



.modal-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(5px);
}

.modal-content {
    position: relative;
    background: white;
    border-radius: 16px;
    max-width: 900px;
    width: 90%;
    max-height: 80vh;
    overflow: hidden;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    animation: modalSlideIn 0.3s ease;
}

@keyframes modalSlideIn {
    from {
        transform: translateY(-50px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.modal-close {
    position: absolute;
    top: 20px;
    right: 20px;
    background: rgba(255, 255, 255, 0.9);
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
}

.modal-close:hover {
    background: var(--accent-color);
    color: white;
    transform: rotate(90deg);
}

.modal-body {
    display: grid;
    grid-template-columns: 1fr 1fr;
    height: 70vh;
    overflow: hidden;
}

.product-image-section {
    background: var(--secondary-color);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 40px;
}

.modal-product-img {
    width: 100%;
    height: 100%;
    max-height: 500px;
    object-fit: cover;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
}

.product-details-section {
    padding: 40px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 25px;
}

.modal-category {
    font-size: 12px;
    color: var(--accent-color);
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: 600;
}

.modal-title {
    font-family: 'Playfair Display', serif;
    font-size: 2rem;
    color: var(--text-primary);
    margin: 5px 0 15px 0;
    line-height: 1.2;
}

.modal-price {
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--primary-color);
    font-family: 'Playfair Display', serif;
}

.product-description h3,
.product-sizes h3 {
    font-size: 16px;
    color: var(--text-primary);
    margin-bottom: 10px;
    font-weight: 600;
}

.product-description p {
    color: var(--text-secondary);
    line-height: 1.6;
    font-size: 14px;
}

.size-selector {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.size-btn {
    width: 45px;
    height: 45px;
    border: 2px solid var(--border-light);
    background: white;
    border-radius: 8px;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.size-btn:hover {
    border-color: var(--accent-color);
    transform: translateY(-2px);
}

.size-btn.active {
    background: var(--accent-color);
    border-color: var(--accent-color);
    color: white;
}

.product-actions {
    display: flex;
    gap: 15px;
    margin: 20px 0;
}

.btn-modal-cart,
.btn-modal-wishlist {
    flex: 1;
    padding: 15px 20px;
    border: none;
    border-radius: 25px;
    font-size: 14px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    text-decoration: none;
}

.btn-modal-cart {
    background: var(--primary-color);
    color: white;
}

.btn-modal-cart:hover {
    background: var(--accent-color);
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
}

.btn-modal-wishlist {
    background: white;
    color: var(--text-secondary);
    border: 1px solid var(--border-light);
}

.btn-modal-wishlist:hover {
    background: #ff4757;
    color: white;
    border-color: #ff4757;
}

.product-info {
    border-top: 1px solid var(--border-light);
    padding-top: 20px;
}

.info-item {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 12px;
    font-size: 13px;
    color: var(--text-secondary);
}

.info-item i {
    color: var(--accent-color);
    width: 16px;
}

/* Grid simples */
.products-grid { display: grid; grid-template-columns: repeat(auto-fill,minmax(240px,1fr)); gap: 20px; }

.qv-buy { flex: 1; display: inline-flex; align-items: center; justify-content: center; gap: 10px;
  background: #1a1a1a; color: #fff; border: 0; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; text-decoration: none; }
.qv-buy:hover { background: #000; }
.qv-fav { background: transparent; border: 0; color: #111; text-align: left; display: inline-flex; gap: 8px; align-items: center; cursor: pointer; }
.qv-fav.active { color: #e74c3c; }

.qv-share { display: flex; align-items: center; gap: 12px; color: #6b7280; }
.qv-share a, .share-copy { width: 36px; height: 36px; border-radius: 50%; border: 1px solid #e5e7eb; display: inline-flex; align-items: center; justify-content: center; color: #111; background: #fff; }
.qv-share a:hover, .share-copy:hover { background: #111; color: #fff; }

.qv-desc { color: #6b7280; line-height: 1.6; }

/* Responsivo */
@media (max-width: 1024px){
  .qv-content{ grid-template-columns: 100px 1fr 360px; }
}
@media (max-width: 860px){
  .qv-dialog{ margin: 10px; }
  .qv-content{ grid-template-columns: 1fr; }
  .qv-gallery{ order: 2; }
  .qv-main{ order: 1; min-height: 320px; }
  .qv-side{ order: 3; }
}

/* Estilos do Banner Rotativo */
.banner-rotativo-section-wrapper {
    max-width: 1400px;
    margin: 60px auto 40px;
    padding: 0 20px;
}

.banner-rotativo-inline {
    width: 100%;
    min-height: 500px;
    margin: 0;
}

.banner-rotativo-inline .banner-rotativo-container {
    position: relative;
    width: 100%;
    height: 500px;
    min-height: 500px;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    background: transparent;
}

.banner-rotativo-section {
    margin: 60px auto;
    max-width: 1400px;
    padding: 0 20px;
}

.banner-rotativo-container {
    position: relative;
    width: 100%;
    height: 450px;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
}

.banner-slide {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    opacity: 0;
    transition: opacity 0.8s ease-in-out;
    pointer-events: none;
    z-index: 1;
    visibility: hidden;
}

.banner-slide.active {
    opacity: 1;
    pointer-events: auto;
    z-index: 2;
    visibility: visible;
}

.banner-content-full {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    height: 100%;
    width: 100%;
    padding: 60px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    position: relative;
}

.banner-content-full::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="0.5" fill="%23fff" opacity="0.03"/><circle cx="75" cy="75" r="0.5" fill="%23fff" opacity="0.03"/><circle cx="50" cy="10" r="0.3" fill="%23fff" opacity="0.03"/><circle cx="20" cy="80" r="0.4" fill="%23fff" opacity="0.03"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
    pointer-events: none;
}

.banner-content-2 {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
}

.banner-content-3 {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
}

/* Banner com imagem */
.banner-content-image {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
}

.banner-image-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.35);
    z-index: 1;
}

.banner-text-over-image {
    position: relative;
    z-index: 2;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.banner-interno-container {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
}

.banner-interno-slide {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    opacity: 0;
    transition: opacity 1s ease-in-out;
    visibility: hidden;
    z-index: 0;
}

.banner-interno-slide.active {
    opacity: 1 !important;
    visibility: visible !important;
    z-index: 2;
}

.banner-content-with-image {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    overflow: hidden;
}

.banner-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.4);
    z-index: 1;
}

.banner-text-content {
    position: relative;
    z-index: 2;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 40px;
}

.banner-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    height: 100%;
    width: 100%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.banner-slide:nth-child(2) .banner-content {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
}

.banner-slide:nth-child(3) .banner-content {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
}

.banner-text {
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 60px;
    color: white;
    z-index: 2;
}

.banner-title {
    font-family: 'Playfair Display', serif;
    font-size: 2.5rem;
    font-weight: 600;
    margin-bottom: 15px;
    line-height: 1.2;
    color: white;
    position: relative;
    z-index: 1;
    letter-spacing: -0.01em;
}

.banner-subtitle {
    font-size: 1.1rem;
    margin-bottom: 30px;
    opacity: 0.95;
    font-weight: 400;
    color: white;
    position: relative;
    z-index: 1;
}

.banner-btn {
    background: white;
    color: #333;
    border: none;
    padding: 14px 35px;
    font-size: 1rem;
    font-weight: 600;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    position: relative;
    z-index: 1;
}

.banner-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    background: rgba(255, 255, 255, 0.95);
}

/* Bot√µes de navega√ß√£o */
.banner-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(255, 255, 255, 0.9);
    border: none;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    color: #333;
    transition: all 0.3s ease;
    z-index: 100;
    backdrop-filter: blur(10px);
}

.banner-nav:hover {
    background: white;
    transform: translateY(-50%) scale(1.1);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
}

.banner-prev {
    left: 20px;
}

.banner-next {
    right: 20px;
}

/* Indicadores */
.banner-indicators {
    position: absolute;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 12px;
    z-index: 100;
}

.indicator {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.5);
    cursor: pointer;
    transition: all 0.3s ease;
}

.indicator.active {
    background: white;
    width: 40px;
    border-radius: 6px;
}

.indicator:hover {
    background: rgba(255, 255, 255, 0.8);
}

/* Responsivo */
@media (max-width: 1024px) {
    .banner-rotativo-container {
        height: 400px;
    }

    .banner-title {
        font-size: 2.5rem;
    }

    .banner-subtitle {
        font-size: 1.1rem;
    }

    .banner-text {
        padding: 40px;
    }
}

@media (max-width: 768px) {
    .banner-rotativo-container {
        height: 500px;
    }

    .banner-content {
        grid-template-columns: 1fr;
        grid-template-rows: 1fr 1fr;
    }

    .banner-text {
        padding: 30px;
        order: 2;
    }

    .banner-image {
        order: 1;
    }

    .banner-title {
        font-size: 2rem;
    }

    .banner-subtitle {
        font-size: 1rem;
        margin-bottom: 20px;
    }

    .banner-btn {
        padding: 14px 32px;
        font-size: 1rem;
    }

    .banner-nav {
        width: 40px;
        height: 40px;
        font-size: 1rem;
    }

    .banner-prev {
        left: 10px;
    }

    .banner-next {
        right: 10px;
    }
}

@media (max-width: 480px) {
    .banner-rotativo-section {
        margin: 30px auto;
    }

    .banner-rotativo-container {
        height: 450px;
        border-radius: 15px;
    }

    .banner-text {
        padding: 20px;
    }

    .banner-title {
        font-size: 1.5rem;
    }

    .banner-subtitle {
        font-size: 0.9rem;
    }
}

</style>

<script>
function imgFallback(el, w=800, h=800, text='Sem Imagem') {
  el.onerror = null;
  const url = `https://placehold.co/${w}x${h}/f0f0f0/666?text=${encodeURIComponent(text)}`;
  const test = new Image();
  test.onload = () => el.src = url;
  test.onerror = () => {
    const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='${w}' height='${h}'>
      <rect width='100%' height='100%' fill='#f0f0f0'/><text x='50%' y='50%' dominant-baseline='middle'
      text-anchor='middle' font-family='Arial' font-size='24' fill='#666'>${text}</text></svg>`;
    el.src = 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(svg);
  };
  test.src = url;
}

// =============== FUN√á√ïES DE NAVEGA√á√ÉO E INTERA√á√ÉO ===============

// Fun√ß√£o para abrir p√°gina de produto
function abrirProduto(produtoId) {
    window.location.href = `/produto/${produtoId}`;
}

// Fun√ß√£o para visualiza√ß√£o r√°pida (modal)
function visualizarRapido(produtoId) {
    // Por enquanto, redireciona para a p√°gina do produto
    // No futuro, pode abrir um modal
    window.location.href = `/produto/${produtoId}`;
}

// Fun√ß√£o para adicionar ao carrinho rapidamente
function adicionarCarrinhoRapido(produtoId) {
    const url = `/carrinho/adicionar/${produtoId}?q=1&tamanho=M&cor=Padr√£o`;
    
    fetch(url, {
        method: 'GET'
    })
    .then(response => {
        if (response.ok) {
            // Mostrar notifica√ß√£o de sucesso
            mostrarNotificacao('Produto adicionado ao carrinho!', 'success');
            
            // Atualizar contador do carrinho se existir
            atualizarContadorCarrinho();
        } else {
            mostrarNotificacao('Erro ao adicionar produto!', 'error');
        }
    })
    .catch(error => {
        console.error('Erro:', error);
        mostrarNotificacao('Erro ao adicionar produto ao carrinho!', 'error');
    });
}

// Fun√ß√£o para toggle favorito
function toggleFavorito(produtoId) {
    const btn = document.querySelector(`[onclick*="toggleFavorito(${produtoId})"]`);
    const icon = btn.querySelector('i');
    
    if (icon.classList.contains('fas')) {
        icon.classList.remove('fas');
        icon.classList.add('far');
        btn.classList.remove('active');
        mostrarNotificacao('Removido dos favoritos', 'info');
    } else {
        icon.classList.remove('far');
        icon.classList.add('fas');
        btn.classList.add('active');
        mostrarNotificacao('Adicionado aos favoritos!', 'success');
    }
}

// Fun√ß√£o para mostrar notifica√ß√µes
function mostrarNotificacao(message, type = 'info') {
    // Verificar se j√° existe uma notifica√ß√£o
    const existingNotification = document.querySelector('.notification');
    if (existingNotification) {
        existingNotification.remove();
    }
    
    // Criar elemento de notifica√ß√£o
    const notification = document.createElement('div');
    notification.className = 'notification';
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#007bff'};
        color: white;
        padding: 15px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        z-index: 10000;
        font-weight: 600;
        max-width: 300px;
        opacity: 0;
        transform: translateX(100%);
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 10px;
    `;
    
    // Adicionar √≠cone baseado no tipo
    const icon = type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : '‚ÑπÔ∏è';
    notification.innerHTML = `${icon} ${message}`;
    
    document.body.appendChild(notification);
    
    // Animar entrada
    setTimeout(() => {
        notification.style.opacity = '1';
        notification.style.transform = 'translateX(0)';
    }, 100);
    
    // Remover ap√≥s 3 segundos
    setTimeout(() => {
        notification.style.opacity = '0';
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 300);
    }, 3000);
}

// Fun√ß√£o para atualizar contador do carrinho
function atualizarContadorCarrinho() {
    const contador = document.querySelector('.cart-count');
    if (contador) {
        fetch('/api/carrinho')
            .then(response => response.json())
            .then(data => {
                const count = data.items ? data.items.length : 0;
                contador.textContent = count;
                contador.style.display = count > 0 ? 'flex' : 'none';
            })
            .catch(error => console.error('Erro ao atualizar contador:', error));
    }
}

// =============== SISTEMA DE FILTROS ===============
let allProducts = [];
let filteredProducts = [];
let activeFilters = {
    categories: [],
    sizes: [],
    priceMin: null,
    priceMax: null,
    quickFilter: null
};

// Inicializar filtros quando a p√°gina carregar
document.addEventListener('DOMContentLoaded', function() {
    initializeFilters();
    loadProducts();
});

// Fun√ß√£o para inicializar o sistema de filtros
function initializeFilters() {
    // Configurar eventos de filtros
    setupFilterEvents();
    
    // Configurar checkbox "Todas as categorias"
    const allCategoriesCheckbox = document.querySelector('input[value=""]:checked');
    if (allCategoriesCheckbox) {
        allCategoriesCheckbox.addEventListener('change', handleAllCategoriesChange);
    }
    
    // Configurar checkbox "Todos os tamanhos"
    const allSizesCheckbox = document.querySelector('.size-options input[value=""]:checked');
    if (allSizesCheckbox) {
        allSizesCheckbox.addEventListener('change', handleAllSizesChange);
    }
}

// Carregar produtos da p√°gina
function loadProducts() {
    const productCards = document.querySelectorAll('.produto-card');
    allProducts = Array.from(productCards).map(card => {
        const nameEl = card.querySelector('.produto-nome');
        const priceEl = card.querySelector('.produto-preco');
        const categoryEl = card.querySelector('.produto-categoria');
        const sizesEl = card.querySelector('.produto-tamanhos');
        
        return {
            element: card,
            name: nameEl ? nameEl.textContent.trim() : '',
            price: priceEl ? parseFloat(priceEl.textContent.replace(/[R$\s.]/g, '').replace(',', '.')) : 0,
            category: categoryEl ? categoryEl.textContent.trim() : '',
            sizes: sizesEl ? sizesEl.textContent.split(',').map(s => s.trim()) : [],
            id: card.dataset.productId || Math.random().toString()
        };
    });
    
    filteredProducts = [...allProducts];
    updateProductCount();
}

// Configurar eventos dos filtros
function setupFilterEvents() {
    // Filtros de categoria
    const categoryCheckboxes = document.querySelectorAll('.filter-options input[type="checkbox"]:not([value=""])');
    categoryCheckboxes.forEach(checkbox => {
        checkbox.addEventListener('change', handleCategoryFilter);
    });
    
    // Filtros de tamanho
    const sizeCheckboxes = document.querySelectorAll('.size-options input[type="checkbox"]:not([value=""])');
    sizeCheckboxes.forEach(checkbox => {
        checkbox.addEventListener('change', handleSizeFilter);
    });
    
    // Filtros de pre√ßo
    const minPriceInput = document.getElementById('min-price');
    const maxPriceInput = document.getElementById('max-price');
    
    if (minPriceInput) {
        minPriceInput.addEventListener('input', debounce(handlePriceFilter, 500));
    }
    if (maxPriceInput) {
        maxPriceInput.addEventListener('input', debounce(handlePriceFilter, 500));
    }
    
    // Filtros r√°pidos
    const quickFilterButtons = document.querySelectorAll('.quick-filter');
    quickFilterButtons.forEach(button => {
        button.addEventListener('click', handleQuickFilter);
    });
}

// Toggle do painel de filtros
function toggleFilters() {
    const filtersPanel = document.getElementById('filters-panel');
    const isActive = filtersPanel.classList.contains('active');
    
    if (isActive) {
        filtersPanel.classList.remove('active');
        document.body.style.overflow = '';
    } else {
        filtersPanel.classList.add('active');
        document.body.style.overflow = 'hidden';
    }
}

// Manipular filtro de categorias
function handleCategoryFilter(event) {
    const value = event.target.value;
    const isChecked = event.target.checked;
    
    if (isChecked) {
        if (!activeFilters.categories.includes(value)) {
            activeFilters.categories.push(value);
        }
    } else {
        activeFilters.categories = activeFilters.categories.filter(cat => cat !== value);
    }
    
    // Desmarcar "Todas as categorias" se alguma categoria espec√≠fica for selecionada
    if (activeFilters.categories.length > 0) {
        const allCategoriesCheckbox = document.querySelector('.filter-options input[value=""]');
        if (allCategoriesCheckbox) {
            allCategoriesCheckbox.checked = false;
        }
    }
    
    filterProducts();
}

// Manipular "Todas as categorias"
function handleAllCategoriesChange(event) {
    const isChecked = event.target.checked;
    
    if (isChecked) {
        // Limpar filtros de categoria e desmarcar todos os checkboxes
        activeFilters.categories = [];
        const categoryCheckboxes = document.querySelectorAll('.filter-options input[type="checkbox"]:not([value=""])');
        categoryCheckboxes.forEach(checkbox => {
            checkbox.checked = false;
        });
    }
    
    filterProducts();
}

// Manipular filtro de tamanhos
function handleSizeFilter(event) {
    const value = event.target.value;
    const isChecked = event.target.checked;
    
    if (isChecked) {
        if (!activeFilters.sizes.includes(value)) {
            activeFilters.sizes.push(value);
        }
    } else {
        activeFilters.sizes = activeFilters.sizes.filter(size => size !== value);
    }
    
    // Desmarcar "Todos os tamanhos" se algum tamanho espec√≠fico for selecionado
    if (activeFilters.sizes.length > 0) {
        const allSizesCheckbox = document.querySelector('.size-options input[value=""]');
        if (allSizesCheckbox) {
            allSizesCheckbox.checked = false;
        }
    }
    
    filterProducts();
}

// Manipular "Todos os tamanhos"
function handleAllSizesChange(event) {
    const isChecked = event.target.checked;
    
    if (isChecked) {
        // Limpar filtros de tamanho e desmarcar todos os checkboxes
        activeFilters.sizes = [];
        const sizeCheckboxes = document.querySelectorAll('.size-options input[type="checkbox"]:not([value=""])');
        sizeCheckboxes.forEach(checkbox => {
            checkbox.checked = false;
        });
    }
    
    filterProducts();
}

// Manipular filtro de pre√ßo
function handlePriceFilter() {
    const minPrice = document.getElementById('min-price');
    const maxPrice = document.getElementById('max-price');
    
    activeFilters.priceMin = minPrice && minPrice.value ? parseFloat(minPrice.value) : null;
    activeFilters.priceMax = maxPrice && maxPrice.value ? parseFloat(maxPrice.value) : null;
    
    filterProducts();
}

// Manipular filtros r√°pidos
function handleQuickFilter(event) {
    const filterType = event.target.dataset.filter || event.target.textContent.toLowerCase();
    const button = event.target;
    
    // Toggle do filtro r√°pido
    if (activeFilters.quickFilter === filterType) {
        activeFilters.quickFilter = null;
        button.classList.remove('active');
    } else {
        // Remover active de outros bot√µes
        document.querySelectorAll('.quick-filter').forEach(btn => {
            btn.classList.remove('active');
        });
        
        activeFilters.quickFilter = filterType;
        button.classList.add('active');
    }
    
    filterProducts();
}

// Definir filtro r√°pido (chamado pelos bot√µes)
function setQuickFilter(filterType) {
    const button = document.querySelector(`[onclick*="${filterType}"]`);
    if (button) {
        handleQuickFilter({ target: button });
    }
}

// Aplicar filtros aos produtos
function filterProducts() {
    filteredProducts = allProducts.filter(product => {
        // Filtro por categoria
        if (activeFilters.categories.length > 0) {
            if (!activeFilters.categories.includes(product.category)) {
                return false;
            }
        }
        
        // Filtro por tamanho
        if (activeFilters.sizes.length > 0) {
            const hasMatchingSize = activeFilters.sizes.some(size => 
                product.sizes.includes(size)
            );
            if (!hasMatchingSize) {
                return false;
            }
        }
        
        // Filtro por pre√ßo
        if (activeFilters.priceMin !== null && product.price < activeFilters.priceMin) {
            return false;
        }
        if (activeFilters.priceMax !== null && product.price > activeFilters.priceMax) {
            return false;
        }
        
        // Filtros r√°pidos
        if (activeFilters.quickFilter) {
            switch (activeFilters.quickFilter) {
                case 'promocao':
                    // L√≥gica para promo√ß√£o (ex: produtos com desconto)
                    // Por enquanto, mostrar produtos com pre√ßo menor que 100
                    if (product.price >= 100) return false;
                    break;
                case 'lancamento':
                    // L√≥gica para lan√ßamentos (ex: produtos recentes)
                    // Por enquanto, mostrar produtos que contenham "novo" no nome
                    if (!product.name.toLowerCase().includes('novo')) return false;
                    break;
                case 'mais-vendidos':
                    // L√≥gica para mais vendidos
                    // Por enquanto, mostrar produtos com pre√ßo entre 50-200
                    if (product.price < 50 || product.price > 200) return false;
                    break;
            }
        }
        
        return true;
    });
    
    updateProductDisplay();
    updateProductCount();
}

// Atualizar exibi√ß√£o dos produtos
function updateProductDisplay() {
    // Esconder todos os produtos
    allProducts.forEach(product => {
        product.element.style.display = 'none';
    });
    
    // Mostrar produtos filtrados
    filteredProducts.forEach(product => {
        product.element.style.display = 'block';
    });
    
    // Adicionar anima√ß√£o suave
    const productsGrid = document.querySelector('.produtos-grid');
    if (productsGrid) {
        productsGrid.style.opacity = '0.7';
        setTimeout(() => {
            productsGrid.style.opacity = '1';
        }, 150);
    }
}

// Atualizar contador de produtos
function updateProductCount() {
    const countElement = document.querySelector('.product-count');
    if (countElement) {
        const count = filteredProducts.length;
        countElement.textContent = `${count} produto${count !== 1 ? 's' : ''}`;
    }
}

// Ordenar produtos
function sortProducts(sortType) {
    let sortedProducts;
    
    switch (sortType) {
        case 'menor-preco':
            sortedProducts = [...filteredProducts].sort((a, b) => a.price - b.price);
            break;
        case 'maior-preco':
            sortedProducts = [...filteredProducts].sort((a, b) => b.price - a.price);
            break;
        case 'nome-az':
            sortedProducts = [...filteredProducts].sort((a, b) => a.name.localeCompare(b.name));
            break;
        case 'nome-za':
            sortedProducts = [...filteredProducts].sort((a, b) => b.name.localeCompare(a.name));
            break;
        case 'mais-novos':
            // Por enquanto, manter ordem original (ou implementar l√≥gica de data)
            sortedProducts = [...filteredProducts];
            break;
        default:
            sortedProducts = [...filteredProducts];
    }
    
    // Reordenar elementos no DOM
    const productsGrid = document.querySelector('.produtos-grid');
    if (productsGrid) {
        // Criar um fragment para otimizar manipula√ß√£o do DOM
        const fragment = document.createDocumentFragment();
        
        sortedProducts.forEach(product => {
            fragment.appendChild(product.element);
        });
        
        // Limpar grid e adicionar produtos ordenados
        productsGrid.innerHTML = '';
        productsGrid.appendChild(fragment);
        
        // Adicionar produtos n√£o filtrados no final (escondidos)
        allProducts.forEach(product => {
            if (!sortedProducts.includes(product)) {
                productsGrid.appendChild(product.element);
            }
        });
    }
    
    filteredProducts = sortedProducts;
}

// Limpar todos os filtros
function clearAllFilters() {
    // Resetar filtros ativos
    activeFilters = {
        categories: [],
        sizes: [],
        priceMin: null,
        priceMax: null,
        quickFilter: null
    };
    
    // Resetar checkboxes de categoria
    const categoryCheckboxes = document.querySelectorAll('.filter-options input[type="checkbox"]');
    categoryCheckboxes.forEach(checkbox => {
        checkbox.checked = checkbox.value === '';
    });
    
    // Resetar checkboxes de tamanho
    const sizeCheckboxes = document.querySelectorAll('.size-options input[type="checkbox"]');
    sizeCheckboxes.forEach(checkbox => {
        checkbox.checked = checkbox.value === '';
    });
    
    // Resetar inputs de pre√ßo
    const minPriceInput = document.getElementById('min-price');
    const maxPriceInput = document.getElementById('max-price');
    if (minPriceInput) minPriceInput.value = '';
    if (maxPriceInput) maxPriceInput.value = '';
    
    // Resetar filtros r√°pidos
    document.querySelectorAll('.quick-filter').forEach(button => {
        button.classList.remove('active');
    });
    
    // Resetar ordena√ß√£o
    const sortDropdown = document.querySelector('.sort-dropdown');
    if (sortDropdown) {
        sortDropdown.value = 'destaque';
    }
    
    // Aplicar filtros (que agora est√£o vazios)
    filterProducts();
}

// Fun√ß√£o utilit√°ria para debounce
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// Fechar filtros ao clicar fora
document.addEventListener('click', function(event) {
    const filtersPanel = document.getElementById('filters-panel');
    const filterToggle = document.querySelector('.filter-toggle');
    
    if (filtersPanel && filtersPanel.classList.contains('active')) {
        if (!filtersPanel.contains(event.target) && !filterToggle.contains(event.target)) {
            toggleFilters();
        }
    }
});

// =============== BANNER ROTATIVO ===============
let bannerAtual = 0;
let bannerInterval;

// Fun√ß√£o para mudar banner
function mudarBanner(direcao) {
    const slides = document.querySelectorAll('.banner-slide');
    const indicators = document.querySelectorAll('.indicator');
    
    if (slides.length === 0) return;
    
    // Verifica se o slide atual existe antes de remover a classe
    if (slides[bannerAtual]) {
        slides[bannerAtual].classList.remove('active');
    }
    if (indicators[bannerAtual]) {
        indicators[bannerAtual].classList.remove('active');
    }
    
    // Calcula novo √≠ndice
    bannerAtual = (bannerAtual + direcao + slides.length) % slides.length;
    
    // Adiciona classe active ao novo slide
    if (slides[bannerAtual]) {
        slides[bannerAtual].classList.add('active');
    }
    if (indicators[bannerAtual]) {
        indicators[bannerAtual].classList.add('active');
    }
    
    // Reinicia o intervalo autom√°tico
    clearInterval(bannerInterval);
    iniciarBannerAutomatico();
}

// Fun√ß√£o para ir para um banner espec√≠fico
function irParaBanner(index) {
    const slides = document.querySelectorAll('.banner-slide');
    const indicators = document.querySelectorAll('.indicator');
    
    if (slides.length === 0 || index < 0 || index >= slides.length) return;
    
    // Remove classe active do slide atual
    if (slides[bannerAtual]) {
        slides[bannerAtual].classList.remove('active');
    }
    if (indicators[bannerAtual]) {
        indicators[bannerAtual].classList.remove('active');
    }
    
    // Define novo √≠ndice
    bannerAtual = index;
    
    // Adiciona classe active ao novo slide
    if (slides[bannerAtual]) {
        slides[bannerAtual].classList.add('active');
    }
    if (indicators[bannerAtual]) {
        indicators[bannerAtual].classList.add('active');
    }
    
    // Reinicia o intervalo autom√°tico
    clearInterval(bannerInterval);
    iniciarBannerAutomatico();
}

// Fun√ß√£o para iniciar rota√ß√£o autom√°tica
function iniciarBannerAutomatico() {
    const slides = document.querySelectorAll('.banner-slide');
    if (slides.length === 0) return;
    
    clearInterval(bannerInterval);
    bannerInterval = setInterval(() => {
        mudarBanner(1);
    }, 4000); // Muda a cada 4 segundos
}

// Inicializar banner quando o DOM estiver pronto
document.addEventListener('DOMContentLoaded', function() {
    const slides = document.querySelectorAll('.banner-slide');
    if (slides.length > 0) {
        // Garantir que o primeiro slide est√° ativo
        slides[0].classList.add('active');
        const indicators = document.querySelectorAll('.indicator');
        if (indicators.length > 0) {
            indicators[0].classList.add('active');
        }
        
        iniciarBannerAutomatico();
        
        // Pausar rota√ß√£o quando o mouse estiver sobre o banner
        const bannerContainer = document.querySelector('.banner-rotativo-container');
        if (bannerContainer) {
            bannerContainer.addEventListener('mouseenter', () => {
                clearInterval(bannerInterval);
            });
            
            bannerContainer.addEventListener('mouseleave', () => {
                iniciarBannerAutomatico();
            });
        }
    }
    
    // Banner interno rotativo (dentro do segundo slide)
    let bannerInternoAtual = 0;
    let bannerInternoInterval;
    
    function mudarBannerInterno() {
        const slidesInternos = document.querySelectorAll('.banner-interno-slide');
        if (slidesInternos.length === 0) return;
        
        // Remove active do slide atual
        if (slidesInternos[bannerInternoAtual]) {
            slidesInternos[bannerInternoAtual].classList.remove('active');
        }
        
        // Calcula pr√≥ximo √≠ndice
        bannerInternoAtual = (bannerInternoAtual + 1) % slidesInternos.length;
        
        // Adiciona active ao novo slide
        if (slidesInternos[bannerInternoAtual]) {
            slidesInternos[bannerInternoAtual].classList.add('active');
        }
    }
    
    function iniciarBannerInterno() {
        const slidesInternos = document.querySelectorAll('.banner-interno-slide');
        if (slidesInternos.length === 0) return;
        
        // Garantir que o primeiro slide interno est√° ativo
        if (slidesInternos[0]) {
            slidesInternos[0].classList.add('active');
        }
        
        clearInterval(bannerInternoInterval);
        bannerInternoInterval = setInterval(() => {
            mudarBannerInterno();
        }, 5000); // Muda a cada 5 segundos
    }
    
    // Iniciar banner interno
    iniciarBannerInterno();
});

// Fechar filtros com tecla Escape
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        const filtersPanel = document.getElementById('filters-panel');
        if (filtersPanel && filtersPanel.classList.contains('active')) {
            toggleFilters();
        }
    }
});
</script>
{% endblock %}
